<!DOCTYPE html>
<html>
<head>
<title>MORSE</title>
<!-- <link rel="stylesheet" href="style.scss" > -->
 <style>

:root {
    --primary: #2B061E;
    --secondary: #919098;
    --selected: #7affa6;
    --solved: #FF857A;
    --unsolved: #414A4C;
  }
  
  /* html body {
    background: var(--primary); 
  } */
  
  body { font-size: 16px; color: #686B5F; background-color: #DBDED3; }
  /* body { font-size: 16px; color: #686B5F; background-color: #731a54; } */
  
  h1 {
    color: var(--secondary);
  }
  .desc{
    color: white;
  }

  .container {
    text-align: center;
    font-family: 'Dosis', sans-serif;
    font-size: 2em;
  }
  
  #word span{
    font-size: 3em;
    font-weight: bold;
    text-transform: uppercase;
    transition: 1s ease all;
  }
  
  #word > :first-child {
    margin-left: 0em !important;
  }
  
  #word > :last-child {
    margin-right: 0em !important;
  }
  
  .to-solve{
   color: var(--unsolved);
  }
  
  .solved {
    color: var(--solved);
  }
  
  .solving {
    color: var(--selected);
    font-size: 1.5em;
    margin: 0 .1em;
  }
  
  /* BTN  */
  @import url('https://fonts.googleapis.com/css?family=Roboto+Slab:400,300');
  body{
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      /* background: #2B061E; */
  }
  .content{	display: flex;}
  /* ////////////////////////////////////////////////
  // The above is just for the layout. */
  .btn-vintage{
      display: block;
      text-align:center;
      margin: 10% 10px;
      height: 170px;
      width: 170px;
      line-height: 170px; /* match button height to center vertically */
      background: #221e25;
      color: #FDFBDA;
      border: 3px solid #eaca6e;
      border-radius: 50%;
      font-size: 70px;
      cursor: pointer;
      user-select: none;
      box-shadow: 
          inset -3px -3px 3px -2px #ffedad, 
          1px 1px 1px 2px #73604c, 
          inset 1px 1px 4px 2px #73604c, 
          -1px -1px 0px 0px #ffedad, 
          1px 2px 6px 4px rgba(20, 20, 20, 0.7), 
          inset 2px 2px 6px 6px #000000;
      transition: all 0.07s linear;
      color: #ff3333;
      position: relative;
      overflow: hidden;
  }
  
  .btn-vintage span{
      background-color: #630000;
      color: transparent;
      text-shadow: 1px 1px 1px #ff6666;
      -webkit-background-clip: text;
      -moz-background-clip: text;
      background-clip: text;
      transition: all 0.1s ease;
      position: relative;
      z-index: 2;
  }
  
  .btn-vintage::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      opacity: 0;
      transition: opacity 0.3s ease;
  }
  
  .btn-vintage:hover::before {
      opacity: 1;
  }
  
  .btn-vintage:hover {
      transform: translateY(-3px);
      box-shadow: 
          inset -3px -3px 3px -2px #ffedad, 
          1px 1px 1px 2px #73604c, 
          inset 1px 1px 4px 2px #73604c, 
          -1px -1px 0px 0px #ffedad, 
          1px 4px 10px 6px rgba(20, 20, 20, 0.8), 
          inset 2px 2px 6px 6px #000000;
  }
  
  .btn-vintage:active, .btn-vintage.active {
      transform: translateY(2px);
      box-shadow: 
          inset -3px -3px 3px -2px #ffedad, 
          1px 1px 1px 2px #73604c, 
          inset 1px 1px 4px 2px #73604c, 
          -1px -1px 0px 0px #ffedad, 
          0px 0px 2px 4px rgba(20, 20, 20, 0.7), 
          inset 4px 4px 6px 6px #000000;
  }
  
  .btn-vintage:active span, .btn-vintage.active span {
      background-color: #ffffff;
      color: transparent;
      text-shadow: -1px -1px 15px #ff3333;
      transform: scale(0.95);
  }
  
  .btn-vintage:active::after, .btn-vintage.active::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 140px;
      height: 140px;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
      transform: translate(-50%, -50%);
      border-radius: 50%;
      animation: ripple 0.6s ease-out;
  }
  
  @keyframes ripple {
      0% {
          width: 0;
          height: 0;
          opacity: 0.5;
      }
      100% {
          width: 200px;
          height: 200px;
          opacity: 0;
      }
  }

  .txt {
	color: white; font-weight: bold;
  }
  
.container-flds {
  display: flex;
  flex-direction: column; 
  gap: 10px; /* Відступи між елементами */
  width: 300px; 
}

.input-group {
  padding: 8px;
  background: #f0f0f0;
  border-radius: 4px;
}

.input-group input {
  width: 100%; /* Щоб input заповнював батьківський div */
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 4px;
}
.readonly-textarea { 
  background-color: #fffde7;
  width: 400px;
  height: 100px;
  font-size: -webkit-xxx-large;
 }


 .corpus {
      display: flex;
  }
 .half {
      flex: 1; /* Розподіляє простір рівномірно */
      min-height: 100px; /* Мінімальна висота для наочності */
      padding: 20px;
      box-sizing: border-box;
    }
    
    /* Кольори для наочності */
    /* .half:first-child {
      background-color: #f0f0f0;
    }
    
    .half:last-child {
      background-color: #e0e0e0;
    } */
 </style>
</head>
<body>
    <div class="container-gadget" 
		style="
		border: 1px solid #2B061E;
		background: #731a54;
		border-radius: 10px;
		width: 90%;
		"
	>
		
	<div class="corpus" style="border: 1px solid cyan; height: 500px;">
			
      <div class="flex-block half" style="border: 1px solid #e7d5e1" >

        <div style="border: 1px solid rgb(255, 0, 111); height: 300px;">
          <h3 class="desc">Morse Code</h3>

          <p id="word"></p>

          <div class="container-flds">
              <div class="input-group">
                <!-- <input id="input" type="text" autocomplete="off" placeholder="text" /> -->
                <textarea placeholder="code" id="morseOutput" class="readonly-textarea input-group" rows="4" cols="50" ></textarea>
                <!-- <div id="morseOutput" class="txt" ></div> -->
              </div>
              <div class="input-group">
                <input id="code" type="text" autocomplete="off" placeholder="code" />
              </div>
              <div class="input-group">
                <input id="stripe" type="text" autocomplete="off" placeholder="stripe" />
              </div>
          </div>

			  </div>

        <div style="border: 1px solid rgb(208, 255, 0)">
          <p id="result"  class="txt">Hold duration: 0 ms</p>

          <p  class="txt">Натискайте кнопку, щоб створити сигнал:</p>
          
          <p class="info txt" >Коротке натискання (<200мс) = крапка (·)<br>Довге натискання (≥200мс) = тире (-)</p>
        
        </div>
        
      </div>

			<!-- <div class="btn-vintage" id="morseButton"> -->
			<div class="half" >
          <div class="btn-vintage" id="morseBtn">
            <span>click</span>
          </div>
			</div>
      <div class="half" >
          <div class="btn-vintage" id="mon">
            <span>click</span>
          </div>
			</div>

		</div>

	</div>

    <script>

    const morseButton = document.getElementById('morseButton');
		const btn = document.getElementById('morseBtn');
		const result = document.getElementById('result');
		const morseOutput = document.getElementById('morseOutput');

    let pressStartTime = 0;
    let morseCode = '';

    btn.addEventListener('mousedown', () => {
      pressStartTime = Date.now();
    });

    btn.addEventListener('mouseup', () => {
      const pressEndTime = Date.now();
      const duration = pressEndTime - pressStartTime;
      result.textContent = `Тривалість натискання: ${duration} мс`;
      
      // Визначаємо символ Морзе
      const symbol = duration < 200 ? '·' : '-';
      morseCode += symbol;
      morseOutput.textContent = morseCode;
    });

    // Для touch-пристроїв
    btn.addEventListener('touchstart', (e) => {
      e.preventDefault();
      pressStartTime = Date.now();
    });

    btn.addEventListener('touchend', (e) => {
      e.preventDefault();
      const pressEndTime = Date.now();
      const duration = pressEndTime - pressStartTime;
      result.textContent = `Тривалість натискання: ${duration} мс`;
      
      const symbol = duration < 200 ? '·' : '-';
      morseCode += symbol;
      morseOutput.textContent = morseCode;
    });

    // audio -- begin
        let audioContext;
        let oscillator;
        let gainNode;

        function startSignal() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            oscillator = audioContext.createOscillator();
            gainNode = audioContext.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.value = 800;
            gainNode.gain.value = 1;
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            btn.classList.add('active');
            // signalButton.classList.add('active');
        }
          function stopSignal() {
            if (gainNode) {
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
                setTimeout(() => {
                    if (oscillator) {
                        oscillator.stop();
                    }
                }, 100);
            }
            // signalButton.classList.remove('active');
            btn.classList.remove('active');
        }
        btn.addEventListener('mousedown', startSignal);
        btn.addEventListener('mouseup', stopSignal);
        btn.addEventListener('mouseleave', stopSignal);
        // Обробники клавіатури
        btn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                startSignal();
            }
        });
        btn.addEventListener('keyup', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                stopSignal();
            }
        });

        // Зупинити сигнал при втраті фокусу
        btn.addEventListener('blur', stopSignal);
    // audio -- end

    // Додаткова функціональність - очищення коду . ???
    // document.addEventListener('keydown', (e) => {
    //   if (e.key === 'Escape') {
    //     morseCode = '';
    //     morseOutput.textContent = '';
    //     result.textContent = 'Тривалість натискання: 0 мс';
    //   }
    // });
	
        // Додаємо обробник події для натискання
        morseButton.addEventListener('mousedown', function() {
			// const btn = document.getElementById('holdBtn');
			const result = document.getElementById('result');

			let pressStartTime = 0;
			pressStartTime = Date.now();
            this.classList.add('active');
        });
    </script>
</body>
</html>